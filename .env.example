# Environment Variables - Template

> **NEVER commit actual secrets to version control**  
> Copy this file to `.env` and fill in your actual values

---

## üîê Backend Environment Variables

```bash
# ===== SERVER CONFIGURATION =====
NODE_ENV=development
PORT=5000

# ===== DATABASE =====
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/maporia?retryWrites=true&w=majority

# ===== AUTH0 CONFIGURATION =====
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_AUDIENCE=https://api.maporia.com
AUTH0_ISSUER_BASE_URL=https://your-tenant.auth0.com
AUTH0_CLIENT_ID=your_client_id
AUTH0_CLIENT_SECRET=your_client_secret

# ===== FIREBASE CONFIGURATION =====
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
FIREBASE_STORAGE_BUCKET=your-project.appspot.com

# ===== API KEYS =====
MAPBOX_ACCESS_TOKEN=pk.eyJ1IjoieW91ci11c2VybmFtZSIsImEiOiJ4eHh4eHh4eHgifQ.xxxxxxxxxxxxx

# ===== CORS =====
CORS_ORIGIN=http://localhost:3000,http://localhost:5173

# ===== JWT CONFIGURATION (if using custom JWT instead of Auth0) =====
JWT_SECRET=your-very-long-and-secure-secret-key-here
JWT_EXPIRES_IN=7d

# ===== RATE LIMITING =====
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100   # Max requests per window

# ===== LOGGING =====
LOG_LEVEL=info  # debug, info, warn, error

# ===== EXTERNAL SERVICES =====
# Email service (if needed)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# Cloudinary (if using instead of Firebase Storage)
CLOUDINARY_CLOUD_NAME=your-cloud-name
CLOUDINARY_API_KEY=your-api-key
CLOUDINARY_API_SECRET=your-api-secret
```

---

## üì± Flutter Environment Variables

Create `mobile/.env`:

```bash
# ===== API CONFIGURATION =====
API_BASE_URL=http://localhost:5000/api
API_TIMEOUT=30000

# ===== AUTH0 CONFIGURATION =====
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_CLIENT_ID=your-mobile-client-id
AUTH0_AUDIENCE=https://api.maporia.com
AUTH0_REDIRECT_URL=com.maporia.app://login-callback

# ===== MAPBOX =====
MAPBOX_ACCESS_TOKEN=pk.eyJ1IjoieW91ci11c2VybmFtZSIsImEiOiJ4eHh4eHh4eHgifQ.xxxxxxxxxxxxx
MAPBOX_STYLE_URL=mapbox://styles/mapbox/light-v11

# ===== FIREBASE =====
FIREBASE_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXX
FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_STORAGE_BUCKET=your-project.appspot.com
FIREBASE_MESSAGING_SENDER_ID=123456789012
FIREBASE_APP_ID=1:123456789012:android:xxxxxxxxxxxxx

# ===== ENVIRONMENT =====
APP_ENV=development  # development, staging, production
```

---

## üöÄ How to Use

### Backend Setup

1. **Copy template**:
   ```bash
   cd backend
   cp .env.example .env
   ```

2. **Fill in values**:
   - Get MongoDB URI from [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
   - Get Auth0 credentials from [Auth0 Dashboard](https://manage.auth0.com/)
   - Get Firebase credentials from [Firebase Console](https://console.firebase.google.com/)
   - Get Mapbox token from [Mapbox Account](https://account.mapbox.com/)

3. **Verify**:
   ```bash
   npm run check-env  # (if we add this script)
   ```

### Flutter Setup

1. **Install flutter_dotenv**:
   ```yaml
   # pubspec.yaml
   dependencies:
     flutter_dotenv: ^5.0.0
   ```

2. **Add to pubspec.yaml**:
   ```yaml
   flutter:
     assets:
       - .env
   ```

3. **Copy template**:
   ```bash
   cd mobile
   cp .env.example .env
   ```

4. **Load in app**:
   ```dart
   // main.dart
   import 'package:flutter_dotenv/flutter_dotenv.dart';

   Future<void> main() async {
     await dotenv.load(fileName: ".env");
     runApp(MyApp());
   }

   // Use variables
   final apiUrl = dotenv.env['API_BASE_URL']!;
   ```

---

## üîí Security Best Practices

### DO ‚úÖ
- Keep `.env` in `.gitignore`
- Use strong, unique secrets for each environment
- Rotate secrets regularly
- Use separate credentials for dev/staging/prod
- Store production secrets in secure vaults (AWS Secrets Manager, etc.)
- Use environment-specific configurations

### DON'T ‚ùå
- Commit `.env` files to git
- Share secrets in chat/email
- Use the same secrets across environments
- Hardcode secrets in source code
- Log secret values
- Use weak or predictable secrets

---

## üåç Environment-Specific Configs

### Development
```bash
NODE_ENV=development
API_BASE_URL=http://localhost:5000
LOG_LEVEL=debug
```

### Staging
```bash
NODE_ENV=staging
API_BASE_URL=https://staging-api.maporia.com
LOG_LEVEL=info
```

### Production
```bash
NODE_ENV=production
API_BASE_URL=https://api.maporia.com
LOG_LEVEL=warn
```

---

## üìù Getting Credentials

### MongoDB Atlas (Free Tier)
1. Create account at [mongodb.com/cloud/atlas](https://www.mongodb.com/cloud/atlas)
2. Create free M0 cluster
3. Create database user
4. Whitelist IP (0.0.0.0/0 for development)
5. Get connection string: `mongodb+srv://...`

### Auth0 (Free Tier)
1. Create account at [auth0.com](https://auth0.com)
2. Create application (Native/SPA for mobile)
3. Create API (for backend)
4. Get Domain, Client ID, Client Secret
5. Configure callback URLs

### Firebase (Free Tier)
1. Create project at [console.firebase.google.com](https://console.firebase.google.com)
2. Add Android/iOS apps
3. Download config files (google-services.json, GoogleService-Info.plist)
4. Enable Storage, FCM, Analytics
5. Get service account key for backend

### Mapbox (Free Tier)
1. Create account at [mapbox.com](https://www.mapbox.com)
2. Go to [Account](https://account.mapbox.com/)
3. Create access token
4. Copy public token

---

## üß™ Testing Environment Variables

Create `backend/.env.test`:

```bash
NODE_ENV=test
MONGODB_URI=mongodb://localhost:27017/maporia-test
AUTH0_DOMAIN=test.auth0.com
# ... other test configs
```

---

## ‚ö†Ô∏è Troubleshooting

### "Missing environment variable" error

**Solution**: Ensure `.env` file exists and contains all required variables

### "Invalid MongoDB connection string"

**Solution**: Check URI format, username/password encoding, cluster name

### "Auth0 authentication failed"

**Solution**: Verify domain, client ID, and callback URLs match

### "Firebase initialization failed"

**Solution**: Check all Firebase credentials and project ID

---

## üìö Additional Resources

- [The Twelve-Factor App - Config](https://12factor.net/config)
- [OWASP Secrets Management](https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html)
- [dotenv npm package](https://www.npmjs.com/package/dotenv)
- [flutter_dotenv package](https://pub.dev/packages/flutter_dotenv)

---

**Remember: Never commit secrets. Always use environment variables!** üîê
